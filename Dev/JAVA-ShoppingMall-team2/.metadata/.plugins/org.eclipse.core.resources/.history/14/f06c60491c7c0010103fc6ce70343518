package com.shopping.test;

import com.shopping.model.User;
import com.shopping.model.Role;
import com.shopping.service.UserService;
import com.shopping.service.AuthService;
import com.shopping.repository.UserRepository;

/**
 * Shopping Mall ì‹œìŠ¤í…œ ìë™í™” í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤
 * ê° ê¸°ëŠ¥ì„ ì²´ê³„ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ê²°ê³¼ë¥¼ ì¶œë ¥
 */
public class ShoppingMallTester {
    
    private UserRepository userRepository;
    private UserService userService;
    private AuthService authService;
    
    // í…ŒìŠ¤íŠ¸ í†µê³„
    private int totalTests = 0;
    private int passedTests = 0;
    private int failedTests = 0;
    
    public ShoppingMallTester() {
        this.userRepository = new UserRepository();
        this.userService = new UserService(userRepository);
        this.authService = new AuthService(userRepository);
    }
    
    public static void main(String[] args) {
        ShoppingMallTester tester = new ShoppingMallTester();
        tester.runAllTests();
    }
    
    /**
     * ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
     */
    public void runAllTests() {
        printHeader("ğŸ›ï¸ Java Shopping Mall ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘");
        
        // í…ŒìŠ¤íŠ¸ ì´ˆê¸°í™”
        setupTestData();
        
        // í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        testUserRegistration();
        testUserLogin();
        testUserInfoManagement();
        testAdminFunctionality();
        testErrorHandling();
        testSecurityFeatures();
        
        // ê²°ê³¼ ì¶œë ¥
        printTestSummary();
    }
    
    /**
     * í…ŒìŠ¤íŠ¸ ë°ì´í„° ì´ˆê¸°í™”
     */
    private void setupTestData() {
        printSection("ğŸ“‹ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì´ˆê¸°í™”");
        
        try {
            // ê¸°ì¡´ ë°ì´í„° ì •ë¦¬ (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì£¼ì˜!)
            userRepository.deleteAll();
            
            // AuthService ì´ˆê¸°í™” ì‹œ ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •ì´ ìƒì„±ë˜ëŠ”ì§€ í™•ì¸
            User admin = userRepository.findByEmail("admin@shopping.com");
            if (admin != null) {
                assertTest("ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ìƒì„±", true, "âœ… ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •ì´ ì •ìƒ ìƒì„±ë¨");
            } else {
                assertTest("ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ìƒì„±", false, "âŒ ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ìƒì„± ì‹¤íŒ¨");
            }
            
        } catch (Exception e) {
            System.out.println("âŒ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì´ˆê¸°í™” ì‹¤íŒ¨: " + e.getMessage());
        }
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 1: íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸
     */
    private void testUserRegistration() {
        printSection("ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 1: íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸");
        
        // 1.1 ì •ìƒ íšŒì›ê°€ì…
        try {
            User user = authService.registerUser("testuser", "test1234", "testuser@test.com", "í…ŒìŠ¤íŠ¸ìœ ì €");
            assertTest("ì •ìƒ íšŒì›ê°€ì…", user != null, "ì‚¬ìš©ì: " + user.getName());
            assertTest("ì´ˆê¸° ì”ì•¡ ì„¤ì •", user.getBalance() == 10000.0, "ì”ì•¡: " + user.getBalance() + "ì›");
            assertTest("ì‚¬ìš©ì ì—­í•  ì„¤ì •", user.getUserRole() == Role.USER, "ì—­í• : " + user.getRole());
        } catch (Exception e) {
            assertTest("ì •ìƒ íšŒì›ê°€ì…", false, "ì‹¤íŒ¨: " + e.getMessage());
        }
        
        // 1.2 ì¤‘ë³µ ì´ë©”ì¼ ê°€ì… ì‹œë„
        try {
            authService.registerUser("testuser2", "test1234", "testuser@test.com", "ì¤‘ë³µìœ ì €");
            assertTest("ì¤‘ë³µ ì´ë©”ì¼ ë°©ì§€", false, "ì¤‘ë³µ ê°€ì…ì´ í—ˆìš©ë¨ (ë¬¸ì œ!)");
        } catch (Exception e) {
            assertTest("ì¤‘ë³µ ì´ë©”ì¼ ë°©ì§€", true, "ì •ìƒì ìœ¼ë¡œ ì°¨ë‹¨ë¨: " + e.getMessage());
        }
        
        // 1.3 ì¤‘ë³µ ID ê°€ì… ì‹œë„  
        try {
            authService.registerUser("testuser", "test1234", "testuser2@test.com", "ì¤‘ë³µIDìœ ì €");
            assertTest("ì¤‘ë³µ ID ë°©ì§€", false, "ì¤‘ë³µ ID ê°€ì…ì´ í—ˆìš©ë¨ (ë¬¸ì œ!)");
        } catch (Exception e) {
            assertTest("ì¤‘ë³µ ID ë°©ì§€", true, "ì •ìƒì ìœ¼ë¡œ ì°¨ë‹¨ë¨: " + e.getMessage());
        }
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 2: ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
     */
    private void testUserLogin() {
        printSection("ğŸ” ì‹œë‚˜ë¦¬ì˜¤ 2: ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸");
        
        // 2.1 ì •ìƒ ë¡œê·¸ì¸ (ì¼ë°˜ ì‚¬ìš©ì)
        try {
            Role role = authService.login("testuser@test.com", "test1234");
            User currentUser = authService.getCurrentUser();
            
            assertTest("ì •ìƒ ë¡œê·¸ì¸", currentUser != null, "ë¡œê·¸ì¸ ì‚¬ìš©ì: " + currentUser.getName());
            assertTest("ì‚¬ìš©ì ì—­í•  í™•ì¸", role == Role.USER, "ì—­í• : " + role);
            assertTest("í˜„ì¬ ì‚¬ìš©ì ì„¤ì •", currentUser.getEmail().equals("testuser@test.com"), "ì´ë©”ì¼ ì¼ì¹˜");
        } catch (Exception e) {
            assertTest("ì •ìƒ ë¡œê·¸ì¸", false, "ì‹¤íŒ¨: " + e.getMessage());
        }
        
        // 2.2 ì˜ëª»ëœ ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸
        try {
            authService.logout(); // ë¨¼ì € ë¡œê·¸ì•„ì›ƒ
            authService.login("notexist@test.com", "test1234");
            assertTest("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ ë¡œê·¸ì¸", false, "ë¡œê·¸ì¸ì´ í—ˆìš©ë¨ (ë¬¸ì œ!)");
        } catch (Exception e) {
            assertTest("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ ë¡œê·¸ì¸", true, "ì •ìƒì ìœ¼ë¡œ ì°¨ë‹¨ë¨");
        }
        
        // 2.3 ì˜ëª»ëœ íŒ¨ìŠ¤ì›Œë“œë¡œ ë¡œê·¸ì¸
        try {
            authService.login("testuser@test.com", "wrongpass");
            assertTest("ì˜ëª»ëœ íŒ¨ìŠ¤ì›Œë“œ ë¡œê·¸ì¸", false, "ë¡œê·¸ì¸ì´ í—ˆìš©ë¨ (ë¬¸ì œ!)");
        } catch (Exception e) {
            assertTest("ì˜ëª»ëœ íŒ¨ìŠ¤ì›Œë“œ ë¡œê·¸ì¸", true, "ì •ìƒì ìœ¼ë¡œ ì°¨ë‹¨ë¨");
        }
        
        // 2.4 ê´€ë¦¬ì ë¡œê·¸ì¸
        try {
            authService.login("admin@shopping.com", "admin123");
            User admin = authService.getCurrentUser();
            Role adminRole = authService.getCurrentRole();
            
            assertTest("ê´€ë¦¬ì ë¡œê·¸ì¸", admin != null, "ê´€ë¦¬ì: " + admin.getName());
            assertTest("ê´€ë¦¬ì ì—­í•  í™•ì¸", adminRole == Role.ADMIN, "ì—­í• : " + adminRole);
            assertTest("ê´€ë¦¬ì ì”ì•¡ í™•ì¸", admin.getBalance() == 0.0, "ì”ì•¡: " + admin.getBalance());
        } catch (Exception e) {
            assertTest("ê´€ë¦¬ì ë¡œê·¸ì¸", false, "ì‹¤íŒ¨: " + e.getMessage());
        }
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 3: ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬ í…ŒìŠ¤íŠ¸
     */
    private void testUserInfoManagement() {
        printSection("â„¹ï¸ ì‹œë‚˜ë¦¬ì˜¤ 3: ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬ í…ŒìŠ¤íŠ¸");
        
        // 3.1 ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ì •ë³´ ì¡°íšŒ
        User currentUser = authService.getCurrentUser();
        if (currentUser != null) {
            assertTest("ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ", true, 
                String.format("ID: %s, ì´ë¦„: %s, ì´ë©”ì¼: %s", 
                    currentUser.getId(), currentUser.getName(), currentUser.getEmail()));
        } else {
            assertTest("ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ", false, "í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ìê°€ ì—†ìŒ");
        }
        
        // 3.2 ë¡œê·¸ì•„ì›ƒ í›„ ì •ë³´ ì¡°íšŒ ì°¨ë‹¨ í…ŒìŠ¤íŠ¸
        authService.logout();
        User afterLogout = authService.getCurrentUser();
        assertTest("ë¡œê·¸ì•„ì›ƒ í›„ í˜„ì¬ ì‚¬ìš©ì", afterLogout == null, "ë¡œê·¸ì•„ì›ƒ ìƒíƒœ í™•ì¸");
        
        // 3.3 UserServiceë¥¼ í†µí•œ ì‚¬ìš©ì ì¡°íšŒ
        User foundUser = userService.findByEmail("testuser@test.com");
        assertTest("ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ", foundUser != null, "ì‚¬ìš©ì ì°¾ê¸° ì„±ê³µ");
        
        User foundById = userService.findById("testuser");
        assertTest("IDë¡œ ì‚¬ìš©ì ì¡°íšŒ", foundById != null, "IDë¡œ ì°¾ê¸° ì„±ê³µ");
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 4: ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
     */
    private void testAdminFunctionality() {
        printSection("ğŸ‘‘ ì‹œë‚˜ë¦¬ì˜¤ 4: ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸");
        
        // ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸
        try {
            authService.login("admin@shopping.com", "admin123");
            User admin = authService.getCurrentUser();
            
            // 4.1 ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
            assertTest("ìƒí’ˆ ì¡°íšŒ ê¶Œí•œ", admin.canBrowseProducts(), "ëª¨ë“  ì‚¬ìš©ì ê°€ëŠ¥");
            assertTest("ì¥ë°”êµ¬ë‹ˆ ê¶Œí•œ", !admin.canAddToCart(), "ê´€ë¦¬ìëŠ” ì¥ë°”êµ¬ë‹ˆ ì‚¬ìš© ë¶ˆê°€");
            assertTest("ì£¼ë¬¸ ê¶Œí•œ", !admin.canPlaceOrder(), "ê´€ë¦¬ìëŠ” ì£¼ë¬¸ ë¶ˆê°€");
            assertTest("ìƒí’ˆ ê´€ë¦¬ ê¶Œí•œ", admin.canManageProducts(), "ê´€ë¦¬ìë§Œ ê°€ëŠ¥");
            assertTest("ì „ì²´ ì£¼ë¬¸ ì¡°íšŒ ê¶Œí•œ", admin.canViewAllOrders(), "ê´€ë¦¬ìë§Œ ê°€ëŠ¥");
            assertTest("ì‚¬ìš©ì ê´€ë¦¬ ê¶Œí•œ", admin.canManageUsers(), "ê´€ë¦¬ìë§Œ ê°€ëŠ¥");
            
            // 4.2 ê´€ë¦¬ì ì”ì•¡ ê´€ë¦¬ í…ŒìŠ¤íŠ¸
            try {
                admin.deductBalance(1000);
                assertTest("ê´€ë¦¬ì ì”ì•¡ ì°¨ê°", false, "ê´€ë¦¬ìê°€ ì”ì•¡ì„ ì‚¬ìš©í•¨ (ë¬¸ì œ!)");
            } catch (IllegalStateException e) {
                assertTest("ê´€ë¦¬ì ì”ì•¡ ì°¨ê° ë°©ì§€", true, "ì •ìƒì ìœ¼ë¡œ ì°¨ë‹¨ë¨");
            }
            
        } catch (Exception e) {
            assertTest("ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸", false, "ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹¤íŒ¨: " + e.getMessage());
        }
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 5: ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
     */
    private void testErrorHandling() {
        printSection("âš ï¸ ì‹œë‚˜ë¦¬ì˜¤ 5: ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸");
        
        // 5.1 ë¹„ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ë¡œê·¸ì•„ì›ƒ ì‹œë„
        authService.logout();
        User loggedOutUser = authService.getCurrentUser();
        assertTest("ë¹„ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸", loggedOutUser == null, "ë¡œê·¸ì•„ì›ƒ ìƒíƒœ ì •ìƒ");
        
        // 5.2 ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì ì¡°íšŒ
        User notFound = userService.findById("notexistuser");
        assertTest("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì ì¡°íšŒ", notFound == null, "null ë°˜í™˜ ì •ìƒ");
        
        // 5.3 UserRepository ì¤‘ë³µ ê²€ì‚¬
        boolean emailExists = userRepository.existsByEmail("testuser@test.com");
        assertTest("ì´ë©”ì¼ ì¡´ì¬ í™•ì¸", emailExists, "ì¤‘ë³µ ê²€ì‚¬ ì •ìƒ ë™ì‘");
        
        boolean emailNotExists = userRepository.existsByEmail("notexist@test.com");
        assertTest("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ í™•ì¸", !emailNotExists, "ì¡´ì¬í•˜ì§€ ì•ŠìŒ í™•ì¸");
    }
    
    /**
     * ì‹œë‚˜ë¦¬ì˜¤ 6: ë³´ì•ˆ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
     */
    private void testSecurityFeatures() {
        printSection("ğŸ”’ ì‹œë‚˜ë¦¬ì˜¤ 6: ë³´ì•ˆ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸");
        
        // 6.1 íŒ¨ìŠ¤ì›Œë“œ í•´ì‹œí™” í™•ì¸
        try {
            User testUser = userRepository.findByEmail("testuser@test.com");
            if (testUser != null) {
                boolean isHashed = !testUser.getPassword().equals("test1234");
                assertTest("íŒ¨ìŠ¤ì›Œë“œ í•´ì‹œí™”", isHashed, "íŒ¨ìŠ¤ì›Œë“œê°€ í•´ì‹œí™”ë˜ì–´ ì €ì¥ë¨");
                
                // ì›ë³¸ íŒ¨ìŠ¤ì›Œë“œì™€ ë‹¤ë¥¸ì§€ í™•ì¸
                assertTest("í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œ ì €ì¥ ë°©ì§€", 
                    testUser.getPassword().length() > 10, 
                    "í•´ì‹œí™”ëœ íŒ¨ìŠ¤ì›Œë“œ ê¸¸ì´: " + testUser.getPassword().length());
            }
        } catch (Exception e) {
            assertTest("íŒ¨ìŠ¤ì›Œë“œ í•´ì‹œí™” í™•ì¸", false, "í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: " + e.getMessage());
        }
        
        // 6.2 ì´ë©”ì¼ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ëŠ” ì¡°íšŒ
        User upperCaseEmail = userRepository.findByEmail("TESTUSER@TEST.COM");
        User lowerCaseEmail = userRepository.findByEmail("testuser@test.com");
        assertTest("ì´ë©”ì¼ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ëŠ” ì¡°íšŒ", 
            upperCaseEmail != null && lowerCaseEmail != null && 
            upperCaseEmail.getId().equals(lowerCaseEmail.getId()),
            "ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ë™ì¼ ì‚¬ìš©ì ì¡°íšŒ");
    }
    
    /**
     * ì¶”ê°€ í†µí•© í…ŒìŠ¤íŠ¸
     */
    public void testCompleteUserJourney() {
        printSection("ğŸš€ í†µí•© í…ŒìŠ¤íŠ¸: ì™„ì „í•œ ì‚¬ìš©ì ì—¬ì •");
        
        try {
            // Step 1: ìƒˆ ì‚¬ìš©ì íšŒì›ê°€ì…
            User newUser = authService.registerUser("journey", "pass1234", "journey@test.com", "ì—¬ì •í…ŒìŠ¤íŠ¸");
            assertTest("ìƒˆ ì‚¬ìš©ì ê°€ì…", newUser != null, "ê°€ì… ì„±ê³µ");
            
            // Step 2: ë¡œê·¸ì¸
            Role role = authService.login("journey@test.com", "pass1234");
            User loggedIn = authService.getCurrentUser();
            assertTest("ì‹ ê·œ ì‚¬ìš©ì ë¡œê·¸ì¸", loggedIn != null && role == Role.USER, "ë¡œê·¸ì¸ ì„±ê³µ");
            
            // Step 3: ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
            assertTest("ì¼ë°˜ ì‚¬ìš©ì ì¥ë°”êµ¬ë‹ˆ ê¶Œí•œ", loggedIn.canAddToCart(), "ì¥ë°”êµ¬ë‹ˆ ì‚¬ìš© ê°€ëŠ¥");
            assertTest("ì¼ë°˜ ì‚¬ìš©ì ì£¼ë¬¸ ê¶Œí•œ", loggedIn.canPlaceOrder(), "ì£¼ë¬¸ ê°€ëŠ¥");
            assertTest("ì¼ë°˜ ì‚¬ìš©ì ê´€ë¦¬ ê¶Œí•œ", !loggedIn.canManageProducts(), "ìƒí’ˆ ê´€ë¦¬ ë¶ˆê°€");
            
            // Step 4: ì”ì•¡ ê´€ë¦¬
            double originalBalance = loggedIn.getBalance();
            assertTest("ì¶©ë¶„í•œ ì”ì•¡ í™•ì¸", loggedIn.hasEnoughBalance(5000), "5000ì› ê²°ì œ ê°€ëŠ¥");
            
            loggedIn.deductBalance(3000);
            assertTest("ì”ì•¡ ì°¨ê°", loggedIn.getBalance() == originalBalance - 3000, 
                "ì°¨ê° í›„ ì”ì•¡: " + loggedIn.getBalance());
            
            // Step 5: ë¡œê·¸ì•„ì›ƒ
            authService.logout();
            assertTest("ì‚¬ìš©ì ì—¬ì • ë¡œê·¸ì•„ì›ƒ", authService.getCurrentUser() == null, "ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ");
            
        } catch (Exception e) {
            assertTest("ì™„ì „í•œ ì‚¬ìš©ì ì—¬ì •", false, "ì‹¤íŒ¨: " + e.getMessage());
        }
    }
    
    /**
     * Repository ë ˆì´ì–´ í…ŒìŠ¤íŠ¸
     */
    public void testRepositoryLayer() {
        printSection("ğŸ—„ï¸ Repository ë ˆì´ì–´ í…ŒìŠ¤íŠ¸");
        
        // ì‚¬ìš©ì ìˆ˜ í™•ì¸
        long userCount = userRepository.count();
        assertTest("ì‚¬ìš©ì ìˆ˜ ì¡°íšŒ", userCount >= 1, "ë“±ë¡ëœ ì‚¬ìš©ì ìˆ˜: " + userCount);
        
        // ì „ì²´ ì‚¬ìš©ì ì¡°íšŒ
        var allUsers = userRepository.findAll();
        assertTest("ì „ì²´ ì‚¬ìš©ì ì¡°íšŒ", allUsers.size() >= 1, "ì¡°íšŒëœ ì‚¬ìš©ì ìˆ˜: " + allUsers.size());
        
        // IDë¡œ ì¡´ì¬ í™•ì¸
        boolean exists = userRepository.existsById("testuser");
        assertTest("ID ì¡´ì¬ í™•ì¸", exists, "testuser ID ì¡´ì¬í•¨");
        
        boolean notExists = userRepository.existsById("notexistuser");
        assertTest("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID í™•ì¸", !notExists, "notexistuser ID ì¡´ì¬í•˜ì§€ ì•ŠìŒ");
    }
    
    // ============ í—¬í¼ ë©”ì„œë“œë“¤ ============
    
    /**
     * í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê²€ì¦ ë° ì¶œë ¥
     */
    private void assertTest(String testName, boolean condition, String message) {
        totalTests++;
        System.out.printf("  %-30s ", testName + ":");
        
        if (condition) {
            System.out.println("âœ… PASS - " + message);
            passedTests++;
        } else {
            System.out.println("âŒ FAIL - " + message);
            failedTests++;
        }
    }
    
    /**
     * ì„¹ì…˜ í—¤ë” ì¶œë ¥
     */
    private void printSection(String title) {
        System.out.println("\n" + "=".repeat(60));
        System.out.println(title);
        System.out.println("=".repeat(60));
    }
    
    /**
     * ì „ì²´ í—¤ë” ì¶œë ¥
     */
    private void printHeader(String title) {
        System.out.println("\n" + "â•”" + "â•".repeat(58) + "â•—");
        System.out.println("â•‘" + centerText(title, 58) + "â•‘");
        System.out.println("â•š" + "â•".repeat(58) + "â•");
    }
    
    /**
     * í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬
     */
    private String centerText(String text, int width) {
        int padding = (width - text.length()) / 2;
        return " ".repeat(padding) + text + " ".repeat(width - text.length() - padding);
    }
    
    /**
     * í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
     */
    private void printTestSummary() {
        System.out.println("\n" + "â•”" + "â•".repeat(58) + "â•—");
        System.out.println("â•‘" + centerText("ğŸ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½", 58) + "â•‘");
        System.out.println("â• " + "â•".repeat(58) + "â•£");
        System.out.printf("â•‘  ì´ í…ŒìŠ¤íŠ¸: %-10dí†µê³¼: %-10dì‹¤íŒ¨: %-10d  â•‘%n", totalTests, passedTests, failedTests);
        
        double successRate = totalTests > 0 ? (double) passedTests / totalTests * 100 : 0;
        System.out.printf("â•‘  ì„±ê³µë¥ : %.1f%%                                          â•‘%n", successRate);
        
        if (failedTests == 0) {
            System.out.println("â•‘  ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí–ˆìŠµë‹ˆë‹¤!                        â•‘");
        } else {
            System.out.println("â•‘  âš ï¸  ì¼ë¶€ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.   â•‘");
        }
        
        System.out.println("â•š" + "â•".repeat(58) + "â•");
        
        // ì¶”ê°€ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        if (failedTests == 0) {
            System.out.println("\nğŸ”„ ì¶”ê°€ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰...");
            testCompleteUserJourney();
            testRepositoryLayer();
            
            // ìµœì¢… ê²°ê³¼
            System.out.println("\n" + "=".repeat(60));
            System.out.printf("ìµœì¢… ê²°ê³¼ - ì´: %d, ì„±ê³µ: %d, ì‹¤íŒ¨: %d (%.1f%%)%n", 
                totalTests, passedTests, failedTests, 
                totalTests > 0 ? (double) passedTests / totalTests * 100 : 0);
        }
    }
    
    /**
     * ì‹¤í–‰ ê°€ëŠ¥í•œ ê°„ë‹¨ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ (ë””ë²„ê¹…ìš©)
     */
    public void quickTest() {
        System.out.println("ğŸ”§ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰...");
        
        try {
            // ê¸°ë³¸ ê°ì²´ ìƒì„± í…ŒìŠ¤íŠ¸
            System.out.println("UserRepository ìƒì„±: " + (userRepository != null ? "âœ…" : "âŒ"));
            System.out.println("UserService ìƒì„±: " + (userService != null ? "âœ…" : "âŒ"));
            System.out.println("AuthService ìƒì„±: " + (authService != null ? "âœ…" : "âŒ"));
            
            // ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • í™•ì¸
            User admin = userRepository.findByEmail("admin@shopping.com");
            System.out.println("ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •: " + (admin != null ? "âœ… ì¡´ì¬" : "âŒ ì—†ìŒ"));
            
            if (admin != null) {
                System.out.println("  - ì´ë¦„: " + admin.getName());
                System.out.println("  - ì—­í• : " + admin.getRole());
                System.out.println("  - ì”ì•¡: " + admin.getBalance());
            }
            
        } catch (Exception e) {
            System.out.println("âŒ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
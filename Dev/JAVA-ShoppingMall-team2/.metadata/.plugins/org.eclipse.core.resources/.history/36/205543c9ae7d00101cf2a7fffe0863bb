package com.shopping.controller;

import java.util.Scanner;

import com.shopping.model.Admin;
import com.shopping.model.User;
import com.shopping.repository.FileAdminRepository;
import com.shopping.repository.FileUserRepository;
import com.shopping.service.AuthService;
import com.shopping.service.UserService;

public class UserController {
	private UserService userService;
	private AuthService authService;
	private Scanner scanner;
	
	// ë¡œê·¸ì¸ ì„±ê³µ í›„ í˜¸ì¶œ
	private void showShoppingUserMenu(User user) {
	    while (true) {
	        System.out.println("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
	        System.out.println("â•‘     ğŸ›ï¸  Java Shopping Mall                 â•‘");
	        System.out.println("â•‘     í™˜ì˜í•©ë‹ˆë‹¤, " + user.getName() + "ë‹˜!                  â•‘");
	        System.out.println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

	        System.out.println("1. ìƒí’ˆ ë‘˜ëŸ¬ë³´ê¸°");
	        System.out.println("2. ìƒí’ˆ ê²€ìƒ‰");
	        System.out.println("3. ì¥ë°”êµ¬ë‹ˆ ê´€ë¦¬");
	        System.out.println("4. ì£¼ë¬¸í•˜ê¸°");
	        System.out.println("5. ì£¼ë¬¸ ë‚´ì—­");
	        System.out.println("6. ë§ˆì´í˜ì´ì§€");
	        System.out.println("7. ë¡œê·¸ì•„ì›ƒ");
	        System.out.print("\në©”ë‰´ë¥¼ ì„ íƒí•˜ì„¸ìš”: ");

	        String choice = scanner.nextLine();
	        
	        switch (choice) {
            case "1":
            	browseProducts();
                System.out.println("ìƒí’ˆ ë‘˜ëŸ¬ë³´ê¸°");
                break;
            case "2":
            	searchProducts();
                System.out.println("ìƒí’ˆ ê²€ìƒ‰");
                break;
            case "3":
            	manageCart();
                System.out.println("ì¥ë°”êµ¬ë‹ˆ ê´€ë¦¬");
                break;
            case "4":
            	Order();
                System.out.println("ì£¼ë¬¸í•˜ê¸°");
                break;
            case "5":
            	ByingList();
                System.out.println("ì£¼ë¬¸ ë‚´ì—­");
                break;
            case "6":
            	myPage();
                System.out.println("ë§ˆì´í˜ì´ì§€");
                break;
            case "7":
                logout(); // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
                System.out.println("ë¡œê·¸ì•„ì›ƒ");
                return;   // ë©”ë‰´ ì¢…ë£Œ
            default:
                System.out.println("ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.");
        }
    }
}

	private void logout() {
		Object nowLoginObj = authService.getLoggedInUser();
		if (nowLoginObj == null) {
			System.out.println("ë¡œê·¸ì¸ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		
		String userName = (nowLoginObj instanceof User ? ((User)nowLoginObj).getName() : ((Admin)nowLoginObj).getName());
		authService.logout();
		System.out.println(userName + "ë‹˜ì´ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.");
	}

	private void myPage() {
		userController.myPage(session);
	}

	private void manageCart() {
		cartController.menu();      // ì¥ë°”êµ¬ë‹ˆ ë©”ë‰´ ì‹¤í–‰
	}

	private void searchProducts() {
		productController.search(); // ìƒí’ˆ ê²€ìƒ‰ ê¸°ëŠ¥
	}

	private void browseProducts() {
		productController.list();   // ìƒí’ˆ ëª©ë¡ ë³´ì—¬ì£¼ê¸°
	}
	
	
